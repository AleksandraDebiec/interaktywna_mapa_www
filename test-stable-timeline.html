<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test: Stabilny Timeline Control Bar</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #333;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            color: white;
        }
        
        /* CONTROLS BAR - stabilny layout z flex */
        #timelineWrap {
            position: relative;
            z-index: 5;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            border-radius: 999px;
            background: rgba(0,0,0,.45);
            box-shadow: 0 4px 16px rgba(0,0,0,.3);
            backdrop-filter: blur(6px);
            box-sizing: border-box;
            width: 600px;
            margin: 20px 0;
        }
        
        /* PRZYCISKI - stała szerokość */
        #timelineWrap .btn.chip,
        #timelineWrap select.chip {
            flex: 0 0 auto;
            min-width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 10px;
            white-space: nowrap;
            box-sizing: border-box;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 18px;
            color: white;
            cursor: pointer;
        }
        
        #timelineWrap .btn.chip.icon {
            flex: 0 0 36px;
            width: 36px;
            padding: 0;
        }
        
        /* LICZNIK CZASU - zarezerwowane miejsce */
        #timelineWrap #timeCounter.chip {
            flex: 0 0 10ch;
            min-width: 10ch;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 8px;
            font-variant-numeric: tabular-nums;
            text-align: center;
            white-space: nowrap;
            box-sizing: border-box;
            background: rgba(255,255,255,0.1);
            border-radius: 18px;
        }
        
        /* SUWAK - pełna dostępna szerokość */
        #timeline {
            flex: 1 1 auto;
            min-width: 0;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            height: 10px;
            background: transparent;
            margin: 0;
            outline: none;
            box-sizing: border-box;
        }
        
        /* TRACK - zaokrąglone końce */
        #timeline::-webkit-slider-runnable-track {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.25);
            border-radius: 999px;
            border: none;
        }
        
        #timeline::-moz-range-track {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.25);
            border-radius: 999px;
            border: none;
        }
        
        /* THUMB - idealne centrowanie */
        #timeline::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #fff;
            border: 0;
            margin-top: -2px;
            box-shadow: 0 0 0 2px rgba(0,0,0,0.15);
            cursor: pointer;
        }
        
        #timeline::-moz-range-thumb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: #fff;
            border: none;
            box-shadow: 0 0 0 2px rgba(0,0,0,0.15);
            cursor: pointer;
        }
        
        /* HOVER */
        #timeline:hover::-webkit-slider-runnable-track,
        #timeline:hover::-moz-range-track {
            background: rgba(255,255,255,0.35);
        }
        
        /* TEST CONTROLS */
        .test-controls {
            margin: 40px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .test-btn {
            padding: 8px 16px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .test-btn:hover {
            background: #005a9e;
        }
        
        .info {
            background: rgba(255,255,255,0.1);
            padding: 12px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 14px;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <h1>Test: Stabilny Timeline Control Bar</h1>
    
    <div class="info">
        <strong>Kryteria testowe:</strong><br>
        • Szerokość suwaka nie zmienia się przy przełączeniu stanów<br>
        • Końce toru są zaokrąglone<br>
        • Kciuk idealnie wycentrowany w osi toru<br>
        • Licznik czasu zachowuje stałe miejsce (10ch)
    </div>
    
    <div id="timelineWrap" aria-label="Oś czasu animacji">
        <button id="btnPause" class="btn chip">Pauza</button>
        <button id="btnReplay" class="btn chip icon" aria-label="Odtwórz ponownie">⟲</button>
        <button id="btnDownload" class="btn chip icon" aria-label="Pobierz">⬇</button>
        <select id="speedSelect" class="chip" aria-label="Prędkość">
            <option value="1">1×</option>
            <option value="2">2×</option>
        </select>
        <div id="timeCounter" class="chip"><span class="now">01:23</span> <span class="sep">/</span> <span class="total">05:47</span></div>
        <input id="timeline" type="range" min="0" max="100" value="25"/>
    </div>
    
    <div class="test-controls">
        <button class="test-btn" onclick="toggleCounter()">Ukryj/Pokaż licznik (visibility)</button>
        <button class="test-btn" onclick="togglePauseText()">Zmień tekst przycisku Pauza</button>
        <button class="test-btn" onclick="changeTimeFormat()">Zmień format czasu</button>
        <button class="test-btn" onclick="measureSlider()">Zmierz szerokość suwaka</button>
    </div>
    
    <div id="measurements" class="info" style="display: none;"></div>
    
    <script>
        let counterVisible = true;
        let pauseText = 'Pauza';
        
        function toggleCounter() {
            const counter = document.getElementById('timeCounter');
            counterVisible = !counterVisible;
            counter.style.visibility = counterVisible ? 'visible' : 'hidden';
            console.log('Licznik:', counterVisible ? 'widoczny' : 'ukryty');
            measureSlider();
        }
        
        function togglePauseText() {
            const btn = document.getElementById('btnPause');
            pauseText = pauseText === 'Pauza' ? 'Wznów' : 'Pauza';
            btn.textContent = pauseText;
            measureSlider();
        }
        
        function changeTimeFormat() {
            const now = document.querySelector('.now');
            const total = document.querySelector('.total');
            const currentNow = now.textContent;
            if (currentNow === '01:23') {
                now.textContent = '0:05';
                total.textContent = '2:30';
            } else {
                now.textContent = '01:23';
                total.textContent = '05:47';
            }
            measureSlider();
        }
        
        function measureSlider() {
            const slider = document.getElementById('timeline');
            const wrapper = document.getElementById('timelineWrap');
            const measurements = document.getElementById('measurements');
            
            const sliderWidth = slider.offsetWidth;
            const wrapperWidth = wrapper.offsetWidth;
            
            measurements.innerHTML = `
                <strong>Pomiary:</strong><br>
                Szerokość suwaka: ${sliderWidth}px<br>
                Szerokość wrappera: ${wrapperWidth}px<br>
                Timestamp: ${new Date().toLocaleTimeString()}
            `;
            measurements.style.display = 'block';
            
            console.log('Suwak:', sliderWidth + 'px', 'Wrapper:', wrapperWidth + 'px');
        }
        
        // Initial measurement
        setTimeout(measureSlider, 100);
        
        // Update slider value display
        const slider = document.getElementById('timeline');
        slider.addEventListener('input', function() {
            console.log('Slider value:', this.value);
        });
    </script>
</body>
</html>